---
interface Props {
  rotateSpeed?: string;
  rotateDirection?: "normal" | "reverse";
  text?: string;
}

const {
  rotateSpeed = "5s",
  rotateDirection = "normal",
  text = "Text rotating around a circle path with SVG!",
}: Props = Astro.props;
---

<div id="container">
  <div id="circle">
    <svg
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      x="0px"
      y="0px"
      width="300px"
      height="300px"
      viewBox="0 0 300 300"
      enable-background="new 0 0 300 300"
      xml:space="preserve"
    >
      <defs>
        <path
          id="circlePath"
          d="M 150, 150 m -60, 0 a 60,60 0 0,1 120,0 a 60,60 0 0,1 -120,0 "
        ></path>
      </defs>
      <circle cx="150" cy="100" r="75" fill="none"></circle>
      <g>
        <use xlink:href="#circlePath" fill="none"></use>
        <text fill="currentColor">
          <textPath xlink:href="#circlePath">{text}</textPath>
        </text>
      </g>
    </svg>
  </div>
</div>

<style>
  :root {
    --rotate-speed: 5s;
    --rotate-direction: normal;
  }

  * {
    border: 1px solid red;
  }

  :global(#container) {
    position: absolute;
    /* position: fixed; */
    right: 0rem;
    top: 0rem;
    z-index: 10;

    width: clamp(8rem, 3.2rem + 24vw, 32rem);
    height: 100%;
  }

  #circle {
    position: sticky;
    top: 2rem;
    width: 100%;
    aspect-ratio: 1;

    overflow: hidden;
    display: flex;
    align-items: flex-start;
    justify-content: center;
  }

  #circle text {
    font-family: var(--font-family-special);
    font-size: 0.875rem;
    color: var(--last-color);
    letter-spacing: 0.135em;
    opacity: 0.8;
    user-select: none;
    /* mix-blend-mode: multiply; */
  }

  #circle svg {
    position: relative;

    animation: rotate var(--rotate-speed) infinite linear;
    animation-direction: var(--rotate-direction);
    aspect-ratio: 1;
    width: 100%;
    height: 100%;
  }

  @keyframes rotate {
    from {
      transform: rotate(360deg);
    }
    to {
      transform: rotate(0);
    }
  }
</style>

<script>
  // Update CSS variables based on props
  const setRotateSpeed = () => {
    if (document.documentElement) {
      document.documentElement.style.setProperty("--rotate-speed", rotateSpeed);
    }
  };

  const setRotateDirection = () => {
    if (document.documentElement) {
      document.documentElement.style.setProperty(
        "--rotate-direction",
        rotateDirection
      );
    }
  };

  setRotateSpeed();
  setRotateDirection();
</script>
